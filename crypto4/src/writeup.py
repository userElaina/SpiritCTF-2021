from Crypto.Util.number import *

e = 65537
c = 19657997127631606992942743387466090025613514791616866084619244565511331009275751254657004083860029307546049827487765683663007284692019872203735287593122174936493232019489974221332262737999303566187062567433594292926330155392795066336870733605934927807359566256054189345062233835679528626798157928425828913137331951198719316416337309777578845263294669984583576274303216220859482713774864583614917007781814657899775029044851924030654910840067642005487252714413547605877161160456630898332376320424332786968077020196308300294854881998189470699894487747955189058432956954125029668448288816890383181280121947964328537054905
n = 20977857259009004424711131349341774112383791753795564430794793616464790390479989769557484064055028084153074073152844991128994649214378790382888555710128487632422934088201295584315660055983665794049139528596544323246746693540444532771859534416570253694662972101395455019811313081343328811776796351463256029940868268780147123230260406380136450556095080195573424801908898298656358177409932489697783110883421284539480928702439642749141044793226447844989989813154920100723960368631770397312345771959014325729955406518847921104706343418694270642936691229028340563922479884289319724075445589127885672037370161179619282365751
leak = 247984630138590638130309955318709885382617832928937021682534035647989431101989319702401538270789502279304198935102384995830111070375467400686480691876229511399973217455375533561841107036788669337640920604617120126204984977196400110445775877022130974599585271966668653175997228526126571745501085259171928699547

def orx(a,b,m):
    res=0
    ind=0
    p=0
    q=0
    while a:
        for i in range(m):
            _p=p+i*(m**ind)
            _q=q+(a%m-i)%m*(m**ind)
            if (_p*_q)%(m**(ind+1))==b%(m**(ind+1)):
                p=_p
                q=_q
                break
        else:
            assert False
        a//=m
        ind+=1
    return p,q

p,q=orx(leak,n,7)
phi=(p-1)*(q-1)
d=inverse(e,phi)
m=pow(c,d,n)
print(long_to_bytes(m).decode('utf8'))
# Spirit{eff7b389-48f8-4edd-b6ec-64ba15badc97}
