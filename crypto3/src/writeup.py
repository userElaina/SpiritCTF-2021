from Crypto.Util.number import *

r = int.from_bytes(b"spirit_2021_crypto_challenge_233333", byteorder="big")
e = 65537
c = 16604706532910688526022808884928068714484342875667856540848323538773001724181250592992404216754975241032471004974046930525619419416016503897010913008666368100681509375513068576330217418971004074007805383232543009211498445244378524912759082939089542219654046615200050147333261075989697901652525114295185650342634865821990620644444326674826141596632642792745479903368078135049045628086929612752045527383611078608050304617085147910827231697655256074690753376219826503007293371761987145916107736414568992994798610191249317504869129435145677682537681787350380104383543310052724170956663245920018071681059978071839686745598
n = 19373743293859282207408705269468184433539455215172914366413350698173583024677811121013573099825612374681013076256457945766216766642809948587428661369251815102755841111097342153655926320470178427731598163319044054197170023183420330567108328238677250031536472325094749358200842848588369898823683435268215953445987273523457249534583010577987859254182926049199596059808772065717456990400560922873687398420133992843978831543966934436876062064886673565362090478585217352066902076131541716550042452663149332206541281880931043380371776699073215009856606325127451188673022352443209744619611404187865636829910867557319857157947
leak = 123503257132046645333273204005871263225656763816733436912867027738116133945377113211311839097994290899662822373053877378454542865975363912890942903479150824714085056438268747110985388952911214366783193546790937371306382672732392119910058361062577492046738388465705606288807160585254761098604863546143359229908

def rox(a,b,m):
    res=0
    ind=0
    while a or b:
        ar = a % m
        br = b % m
        a //= m
        b //= m
        res = res + ((ar - br) % m) * (m ** (ind))
        ind += 1
    return res

p=rox(leak,r,7)
q=n//p
phi=(p-1)*(q-1)
d=inverse(e,phi)
m=pow(c,d,n)
print(long_to_bytes(m).decode('utf8'))
# Spirit{3dd1107f-4441-4750-9649-110e7a9b9ac5}
