c=2154676894633114508433909843984623458638796429804965740086092936316963806871147896493862675399326599358657090356694090340986977523705244373734741114932617472881927967386353007215625397969819509016857813450310842478853860982154776729297546140963176780540351332309585076705019520143912231659603675562943816660911166737829122728506532665660958274049437580604157249286758990507999111760809826907473866462962831889395731569992797032177085972301791987334650833585254930400839342882251688735785165565649449423936698882689408755239188355274906154941684460501331027288022027032316722940444679838138642920169091144536975435632
n=22019234923301236788989964427040741240756594770968901282670042890856278544008053922953838430146844651529237654969959573451506890192622951240872174109757981985812670117963538274027524345614367137698831954445190427871690234380112517998898037898015147837063487915160849948033612926239204785662988083164704322260006812934302908697157644697283252902186474774982230320783593883557919331279852322916658405788180245172469449483716198132223703688793194013760369030197211288751237536506585858053409807145504468407457768628216999630497373580781327690698384355922643451390311567832436522629363451343315665160357481488381067594287
h1=1854525162963668992482402838719509144259488247006676320378625979104002556930382880170397681
h2=1384341777208270810565576072198601861715786399400451378881253218041001471157122050488083967

from gmpy2 import *
mod=pow(2,265)
p0=n*invert(h2,mod)%mod
pbar=(h1<<724)+p0
PR.<x> = PolynomialRing(Zmod(n))
 
for i in range(32):
    f=pbar+x*mod*32
    f=f.monic()
    pp=f.small_roots(X=2^454,beta=0.4)
    if(pp):
        break
    pbar+=mod
 
p=pbar+pp[0]*32*mod
assert n%p==0
print('p=%d'%p)
# p=163662654593282282831417828406601359998547189463139244760639491088069451935243603218319034856252406702741669774044026005463448464410465293333604734305730513420316895515615809911810511765290522565076842645736337133759277951783198711874929217753070327949803842397615957412244100749279269761651935105538358967249
